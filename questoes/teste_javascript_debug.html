<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste JavaScript Debug</title>
    <style>
        .alternative {
            border: 2px solid #ddd;
            padding: 10px;
            margin: 5px 0;
            cursor: pointer;
            border-radius: 5px;
        }
        .alternative:hover {
            background-color: #f0f0f0;
        }
        .alternative-correct {
            background-color: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        .alternative-incorrect-chosen {
            background-color: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        .debug-info {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>Teste JavaScript Debug</h1>
    
    <div class="debug-info">
        <h3>Questão #99</h3>
        <p>Selecione uma alternativa para testar o feedback visual:</p>
    </div>
    
    <div class="question-card" id="questao-99">
        <div class="alternatives-container">
            <div class="alternative" data-alternativa="A" data-alternativa-id="377" data-questao-id="99">
                <span class="alternative-letter">A)</span>
                <span class="alternative-text">A criança está com um atraso significativo no desenvolvimento motor, pois já deveria estar engatinhando.</span>
            </div>
            <div class="alternative" data-alternativa="B" data-alternativa-id="378" data-questao-id="99">
                <span class="alternative-letter">B)</span>
                <span class="alternative-text">O terapeuta ocupacional deve intervir imediatamente para corrigir a forma de locomoção da criança.</span>
            </div>
            <div class="alternative" data-alternativa="C" data-alternativa-id="379" data-questao-id="99">
                <span class="alternative-letter">C)</span>
                <span class="alternative-text">O arrastar é uma forma de locomoção típica, e a criança está explorando seu ambiente de maneira esperada para a idade.</span>
            </div>
            <div class="alternative" data-alternativa="D" data-alternativa-id="380" data-questao-id="99">
                <span class="alternative-letter">D)</span>
                <span class="alternative-text">A criança tem uma fraqueza muscular no tronco, que a impede de adotar a posição de engatinhar.</span>
            </div>
        </div>
    </div>
    
    <div class="debug-info">
        <h3>Debug Console:</h3>
        <div id="debug-console"></div>
    </div>
    
    <script>
        // Simular a função mostrarFeedbackVisual do quiz_vertical_filtros.php
        function mostrarFeedbackVisual(questaoId, alternativaSelecionada, alternativaCorreta, explicacao) {
            console.log('mostrarFeedbackVisual chamada com:', {
                questaoId, alternativaSelecionada, alternativaCorreta, explicacao
            });
            
            const debugConsole = document.getElementById('debug-console');
            debugConsole.innerHTML += `<p>mostrarFeedbackVisual chamada com: questaoId=${questaoId}, alternativaSelecionada=${alternativaSelecionada}, alternativaCorreta=${alternativaCorreta}</p>`;
            
            const questaoCard = document.querySelector(`#questao-${questaoId}`);
            
            if (!questaoCard) {
                console.error('Questão não encontrada:', questaoId);
                debugConsole.innerHTML += `<p style="color: red;">Questão não encontrada: ${questaoId}</p>`;
                return;
            }
            
            console.log('Questão encontrada:', questaoCard);
            debugConsole.innerHTML += `<p>Questão encontrada: ${questaoCard}</p>`;
            
            const alternativas = questaoCard.querySelectorAll('.alternative');
            console.log('Alternativas encontradas:', alternativas.length);
            debugConsole.innerHTML += `<p>Alternativas encontradas: ${alternativas.length}</p>`;
            
            // Marcar alternativa correta como verde
            const alternativaCorretaEl = questaoCard.querySelector(`[data-alternativa="${alternativaCorreta}"]`);
            console.log('Alternativa correta encontrada:', alternativaCorretaEl);
            debugConsole.innerHTML += `<p>Alternativa correta encontrada: ${alternativaCorretaEl}</p>`;
            if (alternativaCorretaEl) {
                alternativaCorretaEl.classList.add('alternative-correct');
                console.log('Classe alternative-correct adicionada');
                debugConsole.innerHTML += `<p>Classe alternative-correct adicionada</p>`;
            }
            
            // Marcar alternativa selecionada
            const alternativaSelecionadaEl = questaoCard.querySelector(`[data-alternativa="${alternativaSelecionada}"]`);
            console.log('Alternativa selecionada encontrada:', alternativaSelecionadaEl);
            debugConsole.innerHTML += `<p>Alternativa selecionada encontrada: ${alternativaSelecionadaEl}</p>`;
            if (alternativaSelecionadaEl) {
                // Se a alternativa selecionada for a correta, ela já foi marcada como verde acima
                // Se for incorreta, marcar como vermelha
                if (alternativaSelecionada !== alternativaCorreta) {
                    alternativaSelecionadaEl.classList.add('alternative-incorrect-chosen');
                    console.log('Classe alternative-incorrect-chosen adicionada');
                    debugConsole.innerHTML += `<p>Classe alternative-incorrect-chosen adicionada</p>`;
                }
            }
        }
        
        // Simular resposta do servidor
        function simularResposta(alternativaSelecionada) {
            console.log('Simulando resposta para alternativa:', alternativaSelecionada);
            
            // Simular diferentes respostas baseadas na alternativa selecionada
            let resposta;
            if (alternativaSelecionada === 'C') {
                // C é a correta neste exemplo
                resposta = {
                    success: true,
                    acertou: true,
                    alternativa_correta: 'C',
                    explicacao: '',
                    message: 'Parabéns! Você acertou!'
                };
            } else {
                // Outras são incorretas
                resposta = {
                    success: true,
                    acertou: false,
                    alternativa_correta: 'C',
                    explicacao: '',
                    message: 'Não foi dessa vez, mas continue tentando!'
                };
            }
            
            console.log('Resposta simulada:', resposta);
            
            // Mostrar feedback visual
            mostrarFeedbackVisual(99, alternativaSelecionada, resposta.alternativa_correta, resposta.explicacao);
        }
        
        // Adicionar event listeners
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM carregado, configurando alternativas...');
            
            const alternativas = document.querySelectorAll('.alternative');
            console.log('Total de alternativas encontradas:', alternativas.length);
            
            alternativas.forEach((alternativa, index) => {
                console.log('Configurando alternativa', index + 1);
                
                alternativa.addEventListener('click', function(e) {
                    const questaoId = this.dataset.questaoId;
                    const alternativaSelecionada = this.dataset.alternativa;
                    
                    console.log('Alternativa clicada:', {
                        questaoId, alternativaSelecionada
                    });
                    
                    // Destacar a alternativa clicada
                    alternativas.forEach(alt => {
                        alt.style.background = '';
                        alt.style.borderColor = '';
                    });
                    
                    this.style.background = '#e3f2fd';
                    this.style.borderColor = '#2196f3';
                    
                    // Simular resposta do servidor
                    simularResposta(alternativaSelecionada);
                });
            });
        });
    </script>
</body>
</html>
